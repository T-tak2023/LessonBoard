<div class="container">
  <h2 class="text-center">レッスンカレンダー</h2>

  <div id='calendar' class="mt-0"></div>

  <div id="eventModal" class="modal" style="display: none;" role="dialog">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content shadow-lg">
        <div class="modal-header bg-primary">
          <h5 class="modal-title text-white">新規登録</h5>
        </div>
        <div class="modal-body">
          <form id="eventForm">
            <div class="mb-3">
              <label for="start_time" class="form-label">開始時間：</label>
              <input type="datetime-local" id="start_time" name="start_time" class="form-control" required>
            </div>
            <div class="mb-3">
              <label for="end_time" class="form-label">終了時間：</label>
              <input type="datetime-local" id="end_time" name="end_time" class="form-control" required>
            </div>
            <div class="mb-3">
              <label for="student_id" class="form-label">生徒：</label>
              <select name="student_id" id="student_id" class="form-select" required>
                <% current_instructor.students.each do |student| %>
                  <option value="<%= student.id %>"><%= student.student_name %></option>
                <% end %>
              </select>
            </div>
            <div class="mb-3">
              <label for="status" class="form-label">ステータス：</label>
              <select name="status" id="status" class="form-select" required>
                <option value="確定">確定</option>
                <option value="保留">保留</option>
                <option value="キャンセル">キャンセル</option>
              </select>
            </div>
            <input type="hidden" id="instructor_id" name="instructor_id" value="<%= current_instructor.id %>">
          </form>
        </div>
        <div class="modal-footer">
          <button type="submit" form="eventForm" class="btn btn-primary">登録する</button>
          <button type="button" id="cancelBtn" class="btn btn-secondary">キャンセル</button>
        </div>
      </div>
    </div>
  </div>

  <div id="eventDetailModal" class="modal" style="display: none;">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 shadow-lg">
      <div class="modal-header bg-primary py-3">
        <h5 class="modal-title text-white">レッスン詳細</h5>
        <button type="button" class="btn-close btn-close-white" id="closeDetailBtn" aria-label="Close"></button>
      </div>
      <div class="modal-body bg-light">
        <div class="row g-3">
          <div class="col-12 col-md-6">
            <div class="card border-primary mb-2">
              <div class="card-body py-2">
                <h6 class="card-subtitle mb-1 text-muted">開始時間</h6>
                <p class="card-text text-primary" id="eventStartTime"></p>
              </div>
            </div>
          </div>
          <div class="col-12 col-md-6">
            <div class="card border-primary mb-2">
              <div class="card-body py-2">
                <h6 class="card-subtitle mb-1 text-muted">終了時間</h6>
                <p class="card-text text-primary" id="eventEndTime"></p>
              </div>
            </div>
          </div>
          <div class="col-12 col-md-6">
            <div class="card border-primary mb-2">
              <div class="card-body py-2">
                <h6 class="card-subtitle mb-1 text-muted">講師</h6>
                <p class="card-text text-primary" id="eventInstructor"></p>
              </div>
            </div>
          </div>
          <div class="col-12 col-md-6">
            <div class="card border-primary mb-2">
              <div class="card-body py-2">
                <h6 class="card-subtitle mb-1 text-muted">生徒</h6>
                <p class="card-text text-primary" id="eventStudent"></p>
              </div>
            </div>
          </div>
          <div class="col-12">
            <div class="card border-primary">
              <div class="card-body py-2">
                <h6 class="card-subtitle mb-1 text-muted">ステータス</h6>
                <p class="card-text text-primary" id="eventStatus"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer bg-light">
        <button id="editEventBtn" class="btn btn-primary">編集</button>
        <button id="deleteEventBtn" class="btn btn-danger">削除</button>
      </div>
    </div>
  </div>
</div>

  <div id="eventEditModal" class="modal" style="display: none;">
    <h2>編集</h2>
    <form id="eventEditForm">
      <label for="edit_start_time">開始時間：</label>
      <input type="datetime-local" id="edit_start_time" name="start_time" required><br>
      <label for="edit_end_time">終了時間：</label>
      <input type="datetime-local" id="edit_end_time" name="end_time" required><br>
      <label for="edit_student_id">生徒：</label>
      <select name="student_id" id="edit_student_id" required>
        <% current_instructor.students.each do |student| %>
          <option value="<%= student.id %>"><%= student.student_name %></option>
        <% end %>
      </select><br>
      <label for="edit_status">ステータス：</label>
      <select name="status" id="edit_status" required>
        <option value="確定">確定</option>
        <option value="保留">保留</option>
        <option value="キャンセル">キャンセル</option>
      </select>
      <input type="hidden" id="edit_instructor_id" name="instructor_id" value="<%= current_instructor.id %>"><br>
      <input type="hidden" id="edit_event_id" name="event_id"><br>
      <button type="submit">保存</button>
      <button type="button" id="cancelEditBtn">キャンセル</button>
    </form>
  </div>
</div>

<%= javascript_include_tag 'lessons' %>
